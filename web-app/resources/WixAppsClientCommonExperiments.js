define.experiment.component("wixapps.integration.components.panels.ProxyStylePanel.StylePerComponent.New",function(e,t){var n=e,r=t;n.methods({setEditedComponent:r.remove(),_createFields:function(){this._originalStyle=this._editedComponent.getStyle().getId(),this._currentlySelectedStyle=this._originalStyle,this._buildStyleButtons()}})}),define.experiment.Class("wixapps.integration.proxies.ClippedParagraphProxy.RichTextViewer.New",function(e,t){var n=e,r=t;n.methods({_getDefaultSkinName:function(){return"wixapps.integration.skins.ClippedParagraphSkin"}})}),define.experiment.Class("wixapps.integration.proxies.InlineTextProxy.RichTextViewer.New",function(e,t){var n=e,r=t;n.methods({_createFormattedText:function(){var e=this._data.getValue(),t=this._getTextAsRichTextElement(e);return t=this._applyDefaultStyleOnText(t),this._isSingleLine()&&t.getFirst().addClass("singleLine"),t.innerHTML},_getBlockDefaultStyledElement:function(e){return new Element("span",{"class":e})},_getAcceptableDataTypes:function(){return["String","Number"]},_getContainerElement:r.remove(),_setupPropertyHandlers:r.remove(),_createRawData:r.remove(),createComponent:r.remove()})}),define.experiment.Class("wixapps.integration.proxies.LabelProxy.RichTextViewer.New",function(e,t){var n=e,r=t;n.resources(["W.Theme"]),n.methods({_createRawData:function(){return{type:"StyledText",text:this._createFormattedText()}},_createFormattedText:function(){var e=this._getInnerText();e=this._prepareLinks(e);var t=this._getTextAsRichTextElement(e);return t=this._applyDefaultStyleOnText(t),this._isSingleLine()&&t.getFirst().addClass("singleLine"),t.innerHTML},_prepareLinks:function(e){return W.Editor||this._def.getChildValue("disableLinks")?e=e.replace(/<a\b[^>]*>(.*?)<\/a>/ig,"$1"):this._updateLinkDataItems(),e},_getInnerText:function(){var e="",t=this._def.getChildValue("prefix"),n=this._def.getChildValue("postfix");t&&(e+=t);var r;return this._data.getTypeName()=="wix:RichText"?(this._migrateHtml(),r=this._data.getChildByRef("text").getValue()):r=this._data.getValue(),r=r.toString().trim(),e+=r,n&&(e+=n),e},_getTextAsRichTextElement:function(e){this._isSingleLine()&&(e=String(e),e=e.replace(/(<p>|<\/p>|<br\/?>)/ig,"")),this._data.getTypeName()!=="wix:RichText"&&(e="<{0}>{1}</{0}>".substitute([this._getDefaultStylePlaceHolderTag(),e]));var t=new Element("div");t.innerHTML=e;if(this._isSingleLine()){var n=t.getFirst();t.empty(),t.grab(n)}return t},_applyDefaultStyleOnText:function(e){var t=e.getElements(this._getDefaultStylePlaceHolderTag());return t.forEach(function(e){this._replaceDefaultStyledElement(e)},this),e},_replaceDefaultStyledElement:function(e){var t=this._getDefaultStyleElement();t.innerElement.innerHTML=e.innerHTML,e.parentNode.replaceChild(t.outerElement,e)},_getDefaultStyleElement:function(){var e=Constants.WixApps.TEXT_STYLES[this._def.getChildValue("style")]||this._getDefaultStyleName(),t=this._getBlockDefaultStyledElement(e),n=t,r=this._def.getChildValue("bold")===!0||this._def.getChildValue("bold")==="true",i=this._def.getChildValue("italic")===!0||this._def.getChildValue("italic")==="true",s=parseInt(this._def.getChildValue("line-height")||this._getLineHeightForStyleCssClass(e),10),o=this._getDefaultColorElement();return o&&(n=this._insertElementToParentElement(n,o)),r&&(n=this._insertElementToParentElement(n,new Element("strong"))),i&&(n=this._insertElementToParentElement(n,new Element("em"))),isNaN(s)||n.setStyle("line-height",s+"em"),this._def.getChildValue("lineThrough")&&(n=this._insertElementToParentElement(n,new Element("strike"))),this._def.getChildValue("underline")&&(n=this._insertElementToParentElement(n,new Element("u"))),{outerElement:t,innerElement:n}},_insertElementToParentElement:function(e,t){return e.grab(t),t},_getBlockDefaultStyledElement:function(e){var t=this._getLineHeightForStyleCssClass(e),n=this._getSeoTagForStyleCssClass(e),r=new Element(n,{"class":e});t&&r.setStyle("line-height",t)},_getDefaultColorElement:function(){var e=null,t=this._def.getChildValue("color");return t&&(e=new Element("span"),this._isCustomColor(t)?e.setStyle("color",t):e.addClass(t)),e},_setTooltip:function(){if(this._shouldShowTooltip(this._element)){var e=this._getInnerText();e=(new Element("div")).set("html",e).get("text"),this._element.setAttribute("title",e)}else this._element.removeAttribute("title")},_migrateHtml:function(){if(!this._data.getChildByRef("isMigrated")||!this._data.getChildByRef("isMigrated").getValue()){var e=new Element(this._getDefaultStylePlaceHolderTag(),{"class":this._getDefaultStyleName()});e.innerHTML=this._data.getChildByRef("text").getValue(),this._data.getChildByRef("isMigrated")&&this._data.getChildByRef("isMigrated").setValue(!0),this._data.getChildByRef("text").setValue(e.outerHTML)}},_getContainerElement:r.remove(),_addStylesOnElement:r.remove(),_addStyleOverrides:r.remove(),_applyColorStyle:r.remove(),_applyLineHeightStyle:r.remove(),_getDefaultSkinName:function(){return"wysiwyg.viewer.skins.WRichTextNewSkin"},_getSeoTagForStyleCssClass:function(e){return"p"},_getDefaultStyleName:function(){return"font_8"},_getDefaultStylePlaceHolderTag:function(){return"hatul"},_getLineHeightForStyleCssClass:function(e){var t=this.resources.W.Theme.getProperty(e);return t.getLineHeight()}})}),define.experiment.Class("wixapps.integration.proxies.RichTextEditorInlineProxy.RichText.New",function(e,t){var n=e,r=t;n.resources(["W.Data"]),n.binds(["_linkIdGenerator","_onEditingCompleted"]),n.methods({initialize:function(e,t,n,r){this.parent(e,t,n,r),this._stylesMap=this.resources.W.Data.getDataByQuery("#WIXAPPS_EDITOR_STYLES")},createComponent:function(){this.useSkinsInsteadOfStyles();var e=W.Data;return W.Editor&&(e=W.Preview.getPreviewManagers().Data),this._updateLinkDataItems(e),this._createWixComponent("wysiwyg.editor.components.richtext.WRichTextEditor",null,{isFixedHeight:!0,isPersistent:!1,generateLinkIdFunc:this._linkIdGenerator,isFixedToolbar:!1,isDraggable:!1})},_createRawData:r.remove(),_onDataChanged:r.remove(),_onComponentWixified:function(){var e=this._def.getChildValue("height"),t=this._element.getWidth();this._migrateHtml();var n=this._data.getChildValue("text");this._componentLogic.addEvent(Constants.ComponentEvents.READY,function(){this._componentLogic.startEditing(n,e,t,this._stylesMap)}.bind(this))},_onEditingCompleted:function(e){var t=this._data.getValue();t.text=e,t.links=this._getLinksDataFromHtml(t.text),t.isMigrated=!0,this._data.setValue(t)},_getLinksDataFromHtml:function(e){var t=e.match(/dataQuery="[^"]*/ig)||[],n=[];for(var r=0;r<t.length;r++){var i=t[r].split('"')[1],s=W.Preview.getPreviewManagers().Data.getDataByQuery(i);n.push(this._createAppsLink(s))}return n},_migrateHtml:function(){if(!this._data.getChildByRef("isMigrated")||!this._data.getChildByRef("isMigrated").getValue()){var e=new Element(this._getDefaultStylePlaceHolderTag(),{"class":this._getDefaultStyleName()});e.innerHTML=this._data.getChildByRef("text").getValue(),this._data.getChildByRef("isMigrated")&&this._data.getChildByRef("isMigrated").setValue(!0),this._data.getChildByRef("text").setValue(e.outerHTML)}},dispose:function(){this._componentLogic&&(this._componentLogic.removeEvent("endEditing",this._onEditingCompleted),this._componentLogic.dispose()),this.parent()},_getDefaultStyleName:function(){return this._stylesMap.get("items").p.cssClass},_getDefaultStylePlaceHolderTag:function(){return this._stylesMap.get("items").p.seoTag},_getDefaultSkinName:function(){return"wixapps.integration.skins.editor.WRichTextInlineEditorSkin"}})}),define.experiment.Class("wixapps.integration.proxies.RichTextEditorProxy.RichText.New",function(e,t){var n=e,r=t;n.resources(["W.Data","W.Utils"]),n.binds(["_linkIdGenerator","_onPreviewClicked","_onEditingCompleted"]),n.methods({initialize:function(e,t,n,r){this.parent(e,t,n,r),this._stylesMap=this.resources.W.Data.getDataByQuery("#WIXAPPS_EDITOR_STYLES")},_onComponentWixified:function(){var e=this._def.getChildValue("height");this._componentLogic.setHeight(e);var t=this._componentLogic.getSkinPart("frame");t.setStyle("height",e+"px"),this._componentLogic.getSkinPart("richTextContainer").addEvent(Constants.CoreEvents.CLICK,this._onPreviewClicked),this._createRTEditorComponent()},_createRTEditorComponent:function(){var e=W.Data;W.Editor&&(e=W.Preview.getPreviewManagers().Data),this._updateLinkDataItems(e);var t=new Element("DIV");t.set("comp","wysiwyg.editor.components.richtext.WRichTextEditor"),t.set("skin","wixapps.integration.skins.editor.WRichTextEditorAppBuilderSkin"),t.set("pos",""),this._editorElement=t,this._editorElement.addEvent(Constants.ComponentEvents.WIXIFIED,function(){}.bind(this)),this._editorElement.addEvent(Constants.ComponentEvents.READY,function(){this._editorLogic=t.getLogic(),this._editorLogic.addEvent("endEditing",this._onEditingCompleted),this._notifyEditorReady()}.bind(this)),this._componentLogic.getSkinPart("frame").grab(t);var n={isFixedHeight:!0,isPersistent:!1,generateLinkIdFunc:this._linkIdGenerator};this._editorElement.wixify(n,this._editorData)},_onEditingCompleted:function(e){var t=this._data.getValue();t.text=e,t.links=this._getLinksDataFromHtml(t.text),this._data.setValue(t)},_getLinksDataFromHtml:function(e){var t=e.match(/dataQuery="[^"]*/ig)||[],n=[];for(var r=0;r<t.length;r++){var i=t[r].split('"')[1],s=W.Preview.getPreviewManagers().Data.getDataByQuery(i);n.push(this._createAppsLink(s))}return n},_getEditorComponent:function(e){this._editorLogic?e(this._editorLogic):this._registerToEditorReadyNotification(e)},_onPreviewClicked:function(e){this._getEditorComponent(function(e){var t=this._element.getWidth(),n=this._def.getChildValue("height"),r=this._data.getChildValue("text");e.startEditing(r,n,t,this._stylesMap)}.bind(this))},_isSingleLine:function(){return!1},_getInnerText:r.remove(),_onEditorDataChanged:r.remove(),getRichTextEditor:r.remove(),_createRawData:r.remove(),_createEditor:r.remove(),_openEditor:r.remove(),_closeEditor:r.remove(),_getContainerForEditor:r.remove(),_getDialogLayer:r.remove(),_getCleanedHtml:r.remove(),_getDefaultStyleElement:function(){var e=this._getBlockDefaultStyledElement();return{outerElement:e,innerElement:e}},_getBlockDefaultStyledElement:function(){var e=this._stylesMap.get("items").p.cssClass,t=this._getSeoTagForStyleCssClass(e);return new Element(t,{"class":e})},_createFormattedText:function(){var e=this.parent(),t=new Element("div");return t.innerHTML=e,this._removeStyleAttributesFromSpans(t),this._replaceAllStylesWithDefault(t),t.innerHTML},_removeStyleAttributesFromSpans:function(e){var t=e.getElements("span");t.forEach(function(e){e.removeAttribute("style"),e.removeAttribute("class")})},_replaceAllStylesWithDefault:function(e){var t=this._stylesMap.get("items").p.cssClass,n=e.getElements('[class*="font_"]');n.forEach(function(e){e.setAttribute("class",t)})},dispose:function(){this._componentLogic&&this._componentLogic.getSkinPart("richTextContainer").removeEvent(Constants.CoreEvents.CLICK,this._onPreviewClicked),this._editorLogic&&(this._editorLogic.removeEvent("endEditing",this._onEditingCompleted),this._editorLogic.dispose()),this.parent()}})}),define.experiment.newSkin("wixapps.integration.skins.ClippedParagraphSkin.RichTextViewer.New",function(e){var t=e;t.inherits("wysiwyg.viewer.skins.WRichTextNewSkin"),t.html('<div skinPart="richTextContainer" class="richTextContainer"></div>')}),define.experiment.newSkin("wixapps.integration.skins.editor.RichTextInlineToolBarSkin.RichText.New",function(e){var t=e;t.inherits("mobile.core.skins.BaseSkin"),t.html('<div class="container"><div class="drag" skinPart="dragArea"></div><ul><li class="part drop fnt style" skinPart="formatBlock" skin="wysiwyg.editor.skins.richtext.ToolBarDropDownSkin"></li><li class="part drop fnt font" skinPart="fontFamily"  skin="wysiwyg.editor.skins.richtext.ToolBarDropDownSkin"></li><li class="part drop fnt fontsize" skinPart="fontSize"    skin="wysiwyg.editor.skins.richtext.ToolBarDropDownSkin"></li><li class="divider"></li><li class="part cols color fc" skinPart="foreColor"   skin="wysiwyg.editor.skins.richtext.ColorSelectorRTEButtonSkin"></li><li class="part cols color bc" skinPart="backColor"   skin="wysiwyg.editor.skins.richtext.ColorSelectorRTEButtonSkin"></li><li class="divider"></li><li class="part btn" skinPart="bold"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="italic"    skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="underline" skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li></ul><ul><li class="part drop size sp" skinPart="letterSpacing" skin="wysiwyg.editor.skins.richtext.ToolBarDropDownSkin"></li><li class="part drop size hg" skinPart="lineHeight"    skin="wysiwyg.editor.skins.richtext.ToolBarDropDownSkin"></li><li class="divider"></li><li class="part btn" skinPart="outdent"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="indent"       skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="divider"></li><li class="part btn" skinPart="numberedlist" skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="bulletedlist" skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="divider"></li><li class="part btn" skinPart="bidiltr"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="bidirtl"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="divider"></li><li class="part cols justify" skinPart="justify"       skin="wysiwyg.editor.skins.richtext.ToolBarDropDownSkin"></li><li class="divider"></li><li class="part btn" skinPart="wixLink"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="wixUnlink"    skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="divider"></li><li class="part btn" skinPart="removeFormat" skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li></ul><div class="close" skinpart="closeButton"></div></div>'),t.skinParams([{id:"hover",type:Constants.SkinParamTypes.OTHER,defaultValue:"border:1px solid #ddd; background-color:#ddd; box-shadow: inset 0 1px 1px rgba(0,0,0,0.4), 0 1px 0 #fff;"},{id:"rd",type:Constants.SkinParamTypes.BORDER_RADIUS,defaultValue:"3px"},{id:"shd",type:Constants.SkinParamTypes.BOX_SHADOW,defaultValue:"0 1px 3px rgba(0,0,0,0.5)"},{id:"tdr",type:Constants.SkinParamTypes.URL,defaultTheme:"WEB_THEME_DIRECTORY"}]),t.css(["%.container% {display:inline-block; font-size:11px; position:relative; color:#353535; background:#f0f0f0; [shd][rd]}","%.drag%  {display: none;}","%.close% {display: none; }","ul {position:relative; padding:2px; margin:0 22px;}",'li.divider { background:url("[tdr]richtext/vertdevider.png") no-repeat 50% 50%; position:relative; height:22px; width:2px; margin:0 8px; display:inline-block; vertical-align:middle;}',"li.part {cursor:pointer; border:1px solid transparent; [rd] position:relative; line-height:22px; height:22px; min-width:22px; margin:1px; display:inline-block; vertical-align:middle;}","li .content {display:none; position:absolute; top:100%; min-width:100px; background:#fff; border-radius:3px; box-shadow:0 1px 3px rgba(0,0,0,0.3); z-index:9999;}","li .content h5 { padding:6px; box-shadow:0 1px 3px rgba(0,0,0,0.4); font-size:12px; color:#666; text-transform:capitalize; background:#f0f0f0;}","li .options {margin:4px; padding:4px; overflow-x:hidden; overflow-y:auto; max-height:220px;}","li .options::-webkit-scrollbar {width: 10px; border-radius: 5px; background: #f0f0f0;}","li .options::-webkit-scrollbar-thumb {width: 10px; border-radius: 5px; background: #ccc;}","li.btn { overflow:hidden;}","li.btn span {height:22px; width:22px;}","li.drop                   {min-width:60px; background-color:#fff; border:1px solid #ccc; box-shadow: inset 0 1px 5px 0px rgba(0,0,0,0.15);}","li.drop:after         {position:absolute; content:url([tdr]richtext/arrow.png); top:0; right:5px; bottom:0; line-height:18px;}","li.drop .select label {padding:0 16px 0 4px; display:inline-block;}","li.drop .select label {text-align:center; white-space:nowrap; overflow:hidden; text-overflow: ellipsis; padding:0 16px 0 4px !important; display:block;}","li.style {width:80px;}","li.style .options { width:150px;}","li.font  {width:100px;}","li.font .options { width:160px;}","li.font .options span {display:block; height:24px; width:100%; margin:0;}","li.font .options label {display:none;}","li.fontsize {width:50px;}","li.size {padding-left:28px; width:50px;}",'li.size:before {position:absolute; z-index:999; content:""; top:0px; left:0px; bottom:0px; width:24px; background:#f0f0f0 url([tdr]richtext/icons.png) no-repeat; border:1px solid #ddd; line-height:22px; border-radius:3px 0 0 3px;}',"li.sp:before {background-position:2px -220px}","li.hg:before {background-position:2px -240px}","li.cols {margin-right:16px;}","li.cols:after {position:absolute; content:url([tdr]richtext/arrow.png); top:0; right:-12px; bottom:0; line-height:18px;}","li.justify {}","li.justify .options {margin:0;}","li.justify .options label {display:none;}","li.color {background:url([tdr]richtext/icons.png) no-repeat; margin-right:16px;}","li.color:after {line-height:16px;}","li.fc {background-position:1px 1px;}","li.bc {background-position:1px -19px;}","li.btn:hover {[hover]}",'li[state="selected"] .content{ display:inline-block; }','li[state="selected"] { [hover] }','li[disabled="disabled"] { background-color: rgba(0, 0, 0, 0.15) !important; opacity:0.25 !important; }','li[state~="selected"]   { [hover]}','li[state~="disabled"]   { background-color: rgba(0, 0, 0, 0.15) !important; opacity:0.25 !important; }'])}),define.experiment.newSkin("wixapps.integration.skins.editor.WRichTextEditorAppBuilderSkin.RichText.New",function(e){var t=e;t.inherits("mobile.core.skins.BaseSkin"),t.html('<textarea skinPart="ckArea" ></textarea><div skinPart="toolBar" skin="wysiwyg.editor.skins.richtext.ToolBarSkin"></div>'),t.css(["{margin:0px; cursor:default; position:absolute; top:0px; bottom:0px; left:0px; right:0px}","%toolBar% {position:fixed; top:350px; left:500px;}"])}),define.experiment.newSkin("wixapps.integration.skins.editor.WRichTextInlineEditorSkin.RichText.New",function(e){var t=e;t.inherits("mobile.core.skins.BaseSkin"),t.html('<div skinPart="toolBar" skin="wixapps.integration.skins.editor.RichTextInlineToolBarSkin"></div><textarea skinPart="ckArea" ></textarea>'),t.css(["{margin:5px; cursor:default;}","%toolBar% { }"])}),define.experiment.skin("wixapps.integration.skins.inputs.RichTextEditorSkin.RichText.New",function(e,t){var n=e;n.html('<div skinPart="frame"><div skinPart="richTextContainer" class="richTextContainer"></div></div>'),n.css(["%frame% { [$borderRadius]; border: 1px solid #b4b4b4; box-shadow: 0 1px 1px 0 [shadowColor] inset; padding:2px; position: relative; }","%richTextContainer% { position:relative; width:100%; height:100%; overflow-y:auto; word-wrap: break-word; }"])});