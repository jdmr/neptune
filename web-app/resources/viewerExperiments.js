define.experiment.component("wysiwyg.viewer.components.FiveGridLine.NBC_HorizontalLine.New",function(e,t){var n=e,r=t;n.inherits("core.components.base.BaseComp"),n.skinParts({line:{type:"htmlElement"}}),n.methods({initialize:function(e,t,n){this.parent(e,t,n),this._resizableSides=[Constants.BaseComponent.ResizeSides.LEFT,Constants.BaseComponent.ResizeSides.RIGHT]},isRenderNeeded:function(e){var t=[this.INVALIDATIONS.SKIN_CHANGE,this.INVALIDATIONS.PART_SIZE];return e.isInvalidated(t)},_onRender:function(e){var t=this._skinParts.line.$measure.height;this.setHeight(t)}})}),define.experiment.component("wysiwyg.viewer.components.FiveGridLine.NewBaseCompFiveGridLine.New",function(e,t){var n=e;n.inherits("core.components.base.BaseComp")}),define.experiment.component("wysiwyg.viewer.components.HorizontalMenu.PartialComponentPreview.New",function(e,t){var n=e,r=t;n.fields({_renderTriggers:[Constants.DisplayEvents.ADDED_TO_DOM,Constants.DisplayEvents.DISPLAYED,Constants.DisplayEvents.SKIN_CHANGE],test:"dooooooode",EDITOR_META_DATA:{general:{settings:!0,design:!0},custom:[{label:"FPP_NAVIGATE_LABEL",command:"WEditorCommands.Pages"}],dblClick:{command:"WEditorCommands.Pages"},partialView:!0},_moreButtonClicked:!1,_prevButtonsWidth:0,_testOverFlowCount:50,_buttonsPadding:{}})}),define.experiment.component("wysiwyg.viewer.components.HtmlComponent.htmlParastorage.New",function(e,t){var n=e,r=t;n.methods({getIFrameSrc:function(){var e=this._data.get("url"),t=/^(ftps|ftp|http|https).*$/;return t.test(e)||(e="http://"+e),e=e.split("static.wix.com").join("static.parastorage.com"),e}})}),define.experiment.component("wysiwyg.viewer.components.MediaZoomDisplayer.LazyShare.New",function(e,t){var n=e,r=t;n.skinParts(r.merge({lazyShare:{type:"wysiwyg.viewer.components.LazySocialPanel",optional:!1}}))}),define.experiment.component("wysiwyg.viewer.components.MediaZoomDisplayer.MobileZoom.New",function(e,t){var n=e,r=t;n.states(r.merge({descriptionPresentationMode:["showLimitedDescription","showAllDescription"]})),n.methods({initialize:function(e,t,n){this.parent(e,t,n);var r=this._getDeviceSize();this._maxWidth=r.width,this._maxHeight=r.height},_onAllSkinPartsReady:r.after(function(){this.setState("showLimitedDescription","descriptionPresentationMode"),this._skinParts.description.addEvent("click",this._onDescriptionClick.bind(this))}),_onDescriptionClick:function(){var e=this.getState("descriptionPresentationMode")=="showLimitedDescription"?"showAllDescription":"showLimitedDescription";this.setState(e,"descriptionPresentationMode")},_getDeviceSize:function(){return{width:window.innerWidth,height:window.innerHeight}},_setCorrectImageSize:function(e){var t=e.y,n=this._getDisplayerWidth(e.x);this._skinParts.imageWrapper.setStyles({width:n+"px",height:t+"px","min-width":"600px"}),this._skinParts.title.setStyles({"word-wrap":"break-word"}),this._skinParts.description.setStyles({"word-wrap":"break-word"})}})}),define.experiment.component("wysiwyg.viewer.components.PageGroup.CSW.New",function(e,t){var n=e,r=t;n.methods({render:function(){this.parent();var e=this.injects().Viewer.getDocWidth();this.setWidth(e)}})}),define.experiment.component("wysiwyg.viewer.components.PageGroup.GridLines.New",function(e,t){var n=e,r=t;n.skinParts({}),n.binds(["onCurrentPageResize","_resizePage","_onTransitionFinished"]),n.methods({toggleGrid:function(){},refreshGrid:function(){},_setHorizontalGrid:function(){},_setVerticalGrid:function(){},_resizePage:function(e){e||(e=this._currentPage.getLogic().getHeight()),this.setHeight(e),W.Layout.enforceAnchors([this])}})}),define.experiment.component("wysiwyg.viewer.components.ScreenWidthContainer.GridLines.New",function(e,t){var n=e,r=t;n.methods({_onResize:function(){this.parent()}})}),define.experiment.component("wysiwyg.viewer.components.SiteButton.NBC_SiteButton.New",function(e,t){var n=e;n.inherits("core.components.base.BaseComp"),n.dataTypes(["SiteButton"]),n.binds(["_onMouseOver","_onMouseOut","_onClick","_onMouseDown","_onMouseUp"]),n.fields({_onRender:function(e){var t=e.data.invalidations;if(this.getDataItem()){var n=this.getDataItem().get("label");this._skinParts.label.set("html",n)}if(t.getInvalidationByType(this.INVALIDATIONS.SKIN_CHANGE)){var r=this.getViewNode();r.addEvent(Constants.CoreEvents.MOUSE_OVER,this._onMouseOver),r.addEvent(Constants.CoreEvents.MOUSE_OUT,this._onMouseOut),r.addEvent(Constants.CoreEvents.MOUSE_DOWN,this._onMouseDown),r.addEvent(Constants.CoreEvents.MOUSE_UP,this._onMouseUp),r.addEvent(Constants.CoreEvents.CLICK,this._onClick)}},_onMouseOver:function(e){this.fireEvent("over",e),this.setState("over")},_onMouseOut:function(e){this.fireEvent("up",e),this.setState("up")},_onClick:function(e){this.fireEvent(Constants.CoreEvents.CLICK,e)},_savedStateForMouseDown:null,_onMouseDown:function(e){this._savedStateForMouseDown=this.getState(),this.setState("pressed"),this.fireEvent(Constants.CoreEvents.MOUSE_DOWN,e)},_onMouseUp:function(e){this.setState(this._savedStateForMouseDown||"up")},getHeight:function(){return this.getPhysicalHeight()},getWidth:function(){return this.getPhysicalWidth()},setHeight:function(e){this.parent(e)},setWidth:function(e){this.parent(e)}})}),define.experiment.component("wysiwyg.viewer.components.TwitterFeed.TwitterAPIpatch.New",function(e,t){var n=e,r=t;n.skinParts({label:{type:"htmlElement"},link:{type:"htmlElement"}}),n.methods({_renderFeed:function(e){if(!this.isReady())return;this.iframeCreated=!0;var t=this._data.get("accountToFollow")||"wix";this._skinParts.label.set("html",t),this._skinParts.link.set("href","https://twitter.com/intent/user?screen_name="+t)}})}),define.experiment.component("wysiwyg.viewer.components.VerticalLine.NBC_VerticalLine.New",function(e,t){var n=e,r=t;n.inherits("core.components.base.BaseComp"),n.skinParts({line:{type:"htmlElement"}}),n.methods({initialize:function(e,t,n){this.parent(e,t,n),this._resizableSides=[Constants.BaseComponent.ResizeSides.TOP,Constants.BaseComponent.ResizeSides.BOTTOM]},isRenderNeeded:function(e){var t=[this.INVALIDATIONS.SKIN_CHANGE,this.INVALIDATIONS.PART_SIZE];return e.isInvalidated(t)},_onRender:function(e){var t=this._skinParts.line.$measure.width;this.setWidth(t)}})}),define.experiment.component("wysiwyg.viewer.components.WPhoto.Aviary.New",function(e,t){var n=e;n.fields({EDITOR_META_DATA:{general:{settings:!0,design:!0},custom:[{label:"PHOTO_REPLACE_IMAGE",command:"WEditorCommands.OpenImageDialog",commandParameter:{galleryTypeID:"photos"}},{label:"PHOTO_EDIT_IMAGE",command:"WEditorCommands.OpenAviaryDialog"},{label:"LINK_LINK_TO",command:"WEditorCommands.OpenLinkDialogCommand",commandParameter:{position:"center"},commandParameterDataRef:"SELF"}],dblClick:{command:"WEditorCommands.OpenImageDialog",commandParameter:{galleryTypeID:"photos"}}}})}),define.experiment.component("wysiwyg.viewer.components.WPhoto.NBC_WPhoto.New",function(e,t){var n=e;n.inherits("core.components.base.BaseComp"),n.fields({initialize:function(e,t,n){this.parent(e,t,n),this._imageSettings=new this.imports.ImageSettings,this._imageDimensions=new this.imports.ImageDimensionsNew,n&&n.props&&this.setComponentProperties(n.props),this._contentPadding={x:0,y:0}},isRenderNeeded:function(e){return this.isDisplayed()&&(e.isInvalidated([this.INVALIDATIONS.PART_SIZE])||this.parent(e))},_onRender:function(e){var t=e.data.invalidations;t.isInvalidated([this.INVALIDATIONS.SKIN_CHANGE,this.INVALIDATIONS.PART_SIZE])&&(this._updateFramePadding(),this._updateImageSize(this.getWidth(),this.getHeight())),this._updateImageSettings(),t.isInvalidated([this.INVALIDATIONS.DATA_CHANGE])&&(this._setTitle(),this._checkResizeInFitMode())},setWidth:function(e,t){this.parent(e),this._updateImageSize(e,null),t||(this._changeCropModeInFit(!0),this._skinParts.img.setSettings(this._imageSettings),this._checkResizeInFitMode())},setHeight:function(e,t){this.parent(e),this._updateImageSize(null,e),t||(this._changeCropModeInFit(!1),this._skinParts.img.setSettings(this._imageSettings),this._checkResizeInFitMode())},_changeCropModeInFit:function(e){if(!this.isDisplayed()||this._getDisplayMode()!=="fitWidth")return;e?this._imageSettings.setCropMode(this._imageSettings.CropModes.FIT_WIDTH):this._imageSettings.setCropMode(this._imageSettings.CropModes.FIT_HEIGHT)},_updateImageSize:function(e,t){if(e){var n=e-this._framePadding.x;this._imageSettings.setWidth(n)}if(t){var r=t-this._framePadding.y;this._imageSettings.setHeight(r)}},_setTitle:function(){var e=this._data.get("title");e&&this._skinParts.view.set("title",e)},_checkResizeInFitMode:function(){var e=this._framePadding;if(this._imageSettings.getCropMode()==this._imageSettings.CropModes.FIT_WIDTH){var t=this._skinParts.img.getSize().y;this.setHeight(t+e.y,!0)}else if(this._imageSettings.getCropMode()==this._imageSettings.CropModes.FIT_HEIGHT){var n=this._skinParts.img.getSize().x;this.setWidth(n+e.x,!0)}},_updateImageSettings:function(){var e=this._getImageCropMode();this._imageSettings.setCropMode(e),this._skinParts.img.setSettings(this._imageSettings)},_updateFramePadding:function(){var e=this.getSkin();this._framePadding={x:parseInt(e.getParamValue("contentPaddingLeft"),10)+parseInt(e.getParamValue("contentPaddingRight"),10),y:parseInt(e.getParamValue("contentPaddingTop"),10)+parseInt(e.getParamValue("contentPaddingBottom"),10)}},_getImageCropMode:function(){var e=this.getComponentProperty("displayMode");return e=="fitWidthStrict"&&(e=this._imageSettings.CropModes.FIT_WIDTH),e=="fitHeightStrict"&&(e=this._imageSettings.CropModes.FIT_HEIGHT),e},_setImageArgs:function(e){return e.argObject={requestExactSize:this.resources.W.Viewer.getPreviewMode()!==!0},e},_getDisplayMode:function(){return this.getComponentProperty("displayMode")},_isFitMode:function(){var e=["fitWidth","fitWidthStrict","fitHeightStrict"];return e.indexOf(this._getDisplayMode())>=0}})}),define.experiment.component("wysiwyg.viewer.components.WRichText.NBC_WRichText.New",function(e,t){var n=e;n.inherits("core.components.base.BaseComp"),n.methods({isRenderNeeded:function(e){var t=[this.INVALIDATIONS.SKIN_CHANGE,this.INVALIDATIONS.DATA_CHANGE];return e.isInvalidated(t)},_onRender:function(e){this._updateText(),this._setLinksDataToElements("VIEW")},_sanitizeLink:function(e){var t=e.get("href");t&&t.indexOf("http://")!==0&&t.indexOf("https://")!==0&&t.indexOf("telnet://")!==0&&t.indexOf("ftp://")!==0&&t.indexOf("mailto:")!==0&&(t.indexOf("@")>0?e.set("href","mailto:"+t):(t.indexOf("www")===0||t.indexOf("www")!==0&&t.indexOf("#")!==0)&&e.set("href","http://"+t))},_onAllSkinPartsReady:t.remove(),_onDataChange:t.remove()})}),define.experiment.component("wysiwyg.viewer.components.WRichText.RichTextViewer.New",function(e){var t=e;t.inherits("mobile.core.components.base.BaseComponent"),t.dataTypes(["RichText","Text","StyledText"]),t.resources(["W.Data","W.Commands","W.Viewer","W.Css"]),t.skinParts({richTextContainer:{type:"htmlElement",optional:!0}}),t.fields({_renderTriggers:[Constants.DisplayEvents.ADDED_TO_DOM,Constants.DisplayEvents.DISPLAYED],EDITOR_META_DATA:{general:{settings:!0,design:!1},custom:[{label:"EDIT_RICH_TEXT",command:"EditorUI.StartEditRichText"}]}}),t.methods({initialize:function(e,t,n){this.resources.W.Commands.registerCommandListenerByName("WPreviewCommands.WEditModeChanged",this,this._setLinksDataToElements),this.parent(e,t,n),this.setMaxH(5e3)},_onAllSkinPartsReady:function(){this._updateText(),this.resources.W.Viewer.getPreviewMode()||this._setLinksDataToElements("VIEW")},_onDataChange:function(){this._skinParts&&this._updateText()},_updateText:function(){this._loadFontsToViewer();var e=this.getDataItem().get("text");this.getRichTextContainer().set("html",e)},getRichTextContainer:function(){return this._skinParts?this._skinParts.richTextContainer||this.getViewNode():null},_setLinksDataToElements:function(e){if(!this._skinParts||e!=="PREVIEW"&&e!=="VIEW")return;var t=$(this.getRichTextContainer()).getElements("a");for(var n=0;n<t.length;n++){var r=t[n],i=r.getAttribute("dataquery");i?this._setLinkAttributes(i,r):this.resources.W.Viewer.getPreviewMode()&&(!r.getAttribute("target")||r.getAttribute("target")!="_blank")&&r.setAttribute("target","_blank")}},_setLinkAttributes:function(e,t){var n=this._getLinkData(e);if(!n)return;var r=this._getLinkHref(n);t.set("href",r);var i=this._getLinkTarget(n);i&&t.set("target",i),this._sanitizeLink(t)},_getLinkData:function(e){var t=e,n=this.resources.W.Data;if(!n.isDataAvailable(t)){t="#"+e;if(!n.isDataAvailable(t))return LOG.reportError(wixErrors.LINK_DATA_ITEM_DOESNT_EXIST,"WRichText","_setLinksDataToElements",e),null}return n.getDataByQuery(t)},_getLinkHref:function(e){var t=e.get("href"),n=e.get("linkType");if(n!="PAGE")return t;try{var r=t.split("/")[1],i=this.resources.W.Data.getDataByQuery("#"+r);t="#!"+i.get("pageUriSEO")+"/"+r}catch(s){}return t},_getLinkTarget:function(e){var t,n=e.get("linkType");return this.resources.W.Viewer.getPreviewMode()&&n!="PAGE"?t="_blank":t=e.get("target"),t},isEditableInPlace:function(){return!0},_loadFontsToViewer:function(){var e=this._getUsedFontsInComp();Object.forEach(e,function(e,t){this.resources.W.Css.loadFont(this._getFontNameInCamelCase(t))},this)},_getUsedFontsInComp:function(){var e=this.getDataItem().get("text"),t=new Element("div");t.innerHTML=e;var n=t.getElements("span[style]"),r=t.getElements("font[face]"),i={};return n.forEach(function(e){var t=e.style["font-family"]||e.style.fontFamily;t&&(t=this._cleanUpFontName(t),i[t]=!0)},this),r.forEach(function(e){var t=e.getAttribute("face");t=this._cleanUpFontName(t),i[t]=!0},this),i},_cleanUpFontName:function(e){return e.replace(/['"]/gi,"")},_getFontNameInCamelCase:function(e){return e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})}})}),define.experiment.component("wysiwyg.viewer.components.WSiteStructure.MobileFixes.New",function(e,t){var n=e,r=t;n.resources(["W.Theme","W.Viewer","W.Config"]),n.methods({initialize:function(e,t,n){this._mobileConfig=this.resources.W.Config.mobileConfig,this._bgNode=new Element("div",{id:"bgNode"}),this._bgNode.setStyles({position:"absolute",width:"100%"}),this._bgNode.inject(document.body,"top"),this._bgStyle={},this._lastBgStyle={},this.parent(e,t,n),window.addEvent("scroll",this._delayedInvalidateBg),window.addEvent("resize",this._delayedInvalidateBg),this.resources.W.Theme.addEvent("propertyChange",this._onThemePropertyChange),this._updateBgProperty(),this._validateBg(),this.setMaxH(this.MAX_SITE_HEIGHT),this.resources.W.Viewer.getPreviewMode()&&this._view.setStyle("padding-bottom",100),this._mobileConfig.isMobileOrTablet()&&(window.addEvent("orientationchange",this._delayedInvalidateBg),this._view.setStyle("overflow","hidden"),this._mobileConfig.isAndroidMobileDevice()&&this._view.setStyle("max-height","10000000000px"))},_updateSiteBgSize:function(){this._mobileConfig.isMobileOrTablet()?this._bgFixed?this._bgStyle.height="100%":this._bgStyle.height=Math.max(this._siteHeight,document.getHeight())+"px":this._bgFixed?this._bgStyle.height=$(document.body).getSize().y+"px":this._bgStyle.height=(this._siteHeight||50)+"px"},_updateSiteBgPosition:function(){Modernizr.positionfixed&&!this._mobileConfig.isMobileOrTablet()?this._bgStyle.position=this._bgFixed?"fixed":"absolute":this._bgStyle.top=this._bgFixed?document.body.scrollTop+"px":0}})}),define.experiment.component("wysiwyg.viewer.components.menus.DropDownMenu.PartialComponentPreview.New",function(e,t){var n=e,r=t;n.fields({_renderTriggers:[Constants.DisplayEvents.ADDED_TO_DOM,Constants.DisplayEvents.DISPLAYED,Constants.DisplayEvents.SKIN_CHANGE],EDITOR_META_DATA:{general:{settings:!0,design:!0},custom:[{label:"FPP_NAVIGATE_LABEL",command:"WEditorCommands.Pages",commandParameter:{galleryConfigID:"pagesPanel"}}],dblClick:{command:"WEditorCommands.Pages"},partialView:!0},_prevButtonsWidth:0,_testOverFlowCount:50,_buttonsPadding:{}})}),define.experiment.component("wysiwyg.viewer.components.tpapps.TPAFixedWidget.TPAFixed.New",function(e,t){var n=e,r=t;n.methods({initialize:function(e,t,n){this.parent(e,t,n),this._$top="auto",this._$left="auto",this._$bottom="auto",this._$right="auto"},render:function(){this.setCoordinates(this._coordinates),this.parent()},isFixedPositioned:function(){return!0},_setCssPosition:function(e,t){var n=e=="auto"||!e&&isNaN(e),r=["top","left","bottom","right"],i=typeof e=="number"?"px":"",s=0,o=0;if(!r.contains(t)){W.Utils.debugTrace("fixedPositionComponent","_setCssPostion",t+" passed as "+e);return}!n&&e&&e.split&&(i=e.split(parseInt(e,10)).join(""),i!=="%"&&(i="px")),e=n?"auto":parseInt(e,10);if(this["_$"+t]!=e){if(!n&&isNaN(e)){W.Utils.debugTrace("fixedPositionComponent","set"+t,"NaN passed as value");return}this["_$"+t]=e+i,this._view.setStyle(t,e+i),t=="left"&&(this._$x=n||i=="%"?this._view.getPosition().x:e),t=="top"&&(this._$y=n||i=="%"?this._view.getPosition().y:e),this.onMovement()}},setLeft:function(e){this._setCssPosition(e,"left");if(e==="50%"){var t=this.getWidth()/2;this._view.setStyle("margin-left",-t)}},setTop:function(e){this._setCssPosition(e,"top");if(e==="50%"){var t=this.getHeight()/2;this._view.setStyle("margin-top",-t)}},_isLeftPositioned:function(){return this.getLeft()!=="auto"},_isHorizCentred:function(){return this.getLeft()==="50%"},_isVertCentred:function(){return this.getTop()==="50%"},_isRightPositioned:function(){return this.getRight()!=="auto"},_isTopPositioned:function(){return this.getTop()!=="auto"},_isBottomPositioned:function(){return this.getBottom()!=="auto"}})}),define.experiment.component("wysiwyg.viewer.components.tpapps.TPAPlaceholder.Staff.Wix",function(e){e.fields({propertiesSchemaName:"WPhotoProperties",EDITOR_META_DATA:{general:{title:"App Placeholder",settings:!0,design:!1},custom:[{label:"PHOTO_REPLACE_IMAGE",command:"WEditorCommands.OpenImageDialog",commandParameter:{galleryTypeID:"photos"},commandParameterDataRef:"SELF"}],dblClick:{command:"WEditorCommands.Market",commandParameterDataRef:"SELF"}}})}),define.experiment.component("wysiwyg.viewer.components.tpapps.TPAFixed.New",function(e,t){var n=e,r=t;n.methods({initialize:function(e,t,n){this.parent(e,t,n),n=n||{},this._rawUrl=n.url,this._url=null,this._containingComponent=n.containingComponent},render:r.remove()})}),define.experiment.newComponent("wysiwyg.viewer.components.tpapps.TPAViewportWidget.TPAFixed.New",function(e){var t=e;t.inherits("wysiwyg.viewer.components.tpapps.TPAFixedWidget"),t.statics({DEF_POSITION:"TOP_LEFT",DEFAULT_COORDINATES:{top:0,left:0,bottom:"auto",right:"auto"}}),t.methods({initialize:function(e,t,n){this.parent(e,t,n),this._resizableSides=[]},onDataInitialized:function(e){this._position=this._appData.position||this.DEF_POSITION,this._coordinates=this._getFixedWidgetCoordinates()},_getFixedWidgetCoordinates:function(){var e=this.getWidgetId(),t=this._appData.widgets[e],n=t.defaultWidth||200,r=t.defaultHeight||200,i="auto",s="auto",o="auto",u="auto";switch(this._position){case"TOP_LEFT":s=0,i=0;break;case"TOP_RIGHT":u=0,i=0;break;case"BOTTOM_RIGHT":u=0,o=0;break;case"BOTTOM_LEFT":s=0,o=0;break;case"TOP_CENTER":i=0,s="50%";break;case"CENTER_RIGHT":i="50%",u=0;break;case"BOTTOM_CENTER":o=0,s="50%";break;case"CENTER_LEFT":s=0,i="50%";break;default:i=0,s="50%"}return{width:n,height:r,top:i,left:s,bottom:o,right:u}},isMultiSelectable:function(){return!1},canMoveToOtherScope:function(){return!1},isDraggable:function(){return!1},isDuplicatable:function(){return!0},getShowOnAllPagesChangeability:function(){return!1},getX:function(){var e=0;if(this._isLeftPositioned())this._isHorizCentred()?e=this._view.getPosition().x-this._getPageMargin():e=-this._getPageMargin();else if(this._isRightPositioned()){var t=this._getPageSize();e=t.x+this._getPageMargin()-this.getWidth()}return e},getY:function(){var e=0;return this._isTopPositioned()?this._isVertCentred()?e=(window.innerHeight-this.getHeight())/2:e=0:this._isBottomPositioned()&&(e=window.innerHeight-this.getHeight()),e},getSelectableY:function(){return this.getY()+window.pageYOffset},_getPageMargin:function(){var e=this.injects().Viewer.getSiteNode(),t=e.getSize();return(window.innerWidth-t.x)/2},_getPageSize:function(){var e=this.injects().Viewer.getSiteNode();return e.getSize()}})}),define.experiment.Class("wysiwyg.viewer.managers.PageManager.JITPageLoader.New",function(e,t){var n=e,r=t;n.methods({initialize:r.after(function(){this._loadedPages=[],this._loadingPages=[],this._loadingPagesTrialCounter={},this._getPagesList()&&this._getPagesList().pages.each(function(e){this._loadingPagesTrialCounter[e.pageId]=0}.bind(this)),this._callBacksForPageCreation={}}),getPageData:function(e,t){if(!e||!e.urls)throw"page is not listed in the pages list or it does not have url";if(typeof t!="function")throw"callback ["+t+"] supplied is not a function";this._requestPageJson(e.urls,t,e)},_requestPageJson:function(e,t,n){this._restClient.get(e[0],undefined,{onSuccess:t,onError:this._getErrorCallbackForUrl(e,t,n)})},_getErrorCallbackForUrl:function(e,t,n){if(e.length==1)return function(){n&&this._loadingPages.splice(this._loadingPages.indexOf(n.pageId),1),LOG.reportError(wixErrors.ALL_PAGE_RETRIEVAL_ATTEMPTS_FAILED,"PageManager","_requestPageJson")}.bind(this);var r=e.clone();return r.splice(0,1),function(){LOG.reportError(wixErrors.SINGLE_PAGE_RETRIEVAL_ATTEMPT_FAILED,"PageManager","_requestPageJson",r[0]),this._requestPageJson(r,t,n)}.bind(this)},createPage:function(e){var t=this._getJsonForString(e),n=t.data||t.payload.data;this._setInitDataForPage(n);var r=t.structure||t.payload.structure,i=this._createPageElements(r);this._attachPageWhenReady(i,r.id)},_setInitDataForPage:function(e){var t=this.dataFixer.fix(e);W.Data.addDataItemsForPage(t.document_data),W.ComponentData.addDataItemsForPage(t.component_properties),W.Theme.addDataItemsForPage(t.theme_data)},_attachPageWhenReady:function(e,t){$(t)?(this._attachPage(e,t),this._loadedPages.push(t),W.Utils.callLater(this._callBacksForPageCreation[t].method,[],this._callBacksForPageCreation[t].scope,10),this.fireEvent("PAGE_LOADED",t)):W.Utils.callLater(this._attachPageWhenReady,[e,t],this,10)},_attachPage:function(e,t){var n=$(t);n.getLogic?this._attachPageContentToWixifiedPage(n,e):e.replaces(n)},_attachPageContentToWixifiedPage:function(e,t){var n=e.getLogic();e.empty(),t.getChildren().each(function(t){e.grab(t,"bottom")}),t.get("styleId")!=e.get("styleId")?(e.set("styleId",t.get("styleId")),W.Theme.getStyle(t.get("styleId"),function(e){n.setStyle(e)})):e.get("skin")!==t.get("skin")&&(e.set("skin",t.get("skin")),W.Skins.getSkin(t.get("skin"),function(e){var t=new e;n.setSkin(t)})),t.get("dataQuery")!=e.get("dataQuery")&&(e.set("dataQuery",t.get("dataQuery")),n.setDataByQuery(t.get("dataQuery"),function(){})),t.get("propertyQuery")!=e.get("propertyQuery")&&(e.set("propertyQuery",t.get("propertyQuery")),W.Data.getDataByQuery(t.get("propertyQuery"),n.setComponentProperties))},_attachMasterPage:function(e){$$("body")[0].grab(e,"top")},_createMasterPage:r.after(function(){this._addPagesStubs()}),_addPagesStubs:function(){Object.each(this._getPagesList().pages,function(e){$("SITE_PAGES").grab(this._createStubPage(e))}.bind(this))},_createStubPage:function(e){var t=new Element("div");return t.set({id:e.pageId,comp:"mobile.core.components.Page",skin:"mobile.core.skins.InlineSkin",dataQuery:"#"+e.pageId}),t},isPageLoaded:function(e){return this._isOldPageVersion()||this._loadedPages.contains(e)||this._loadingPages.contains(e)},loadPageById:function(e,t,n){var r=this._getPageDataById(e);!this._loadedPages.contains(e)&&!this._loadingPages.contains(e)&&(this._loadingPagesTrialCounter[e]++,this._loadingPages.push(e),this._callBacksForPageCreation[e]={method:t,scope:n},this._loadSinglePage(r))},_getPageDataById:function(e){return this._getPagesList().pages.first(function(t){return t.pageId===e})},_loadAllPages:function(e){this.addEvent("PAGE_LOADED",function(t){e.erase(t),e.length===0&&(this._allPagesAreLoaded=!0)}.bind(this)),e.each(function(e){this.loadPageById(e)}.bind(this))},_loadAllPagesLazily:function(){var e=this._getNextUnloadedPage();e&&(this.loadPageById(e.pageId),W.Utils.callLater(this._loadAllPagesLazily,[],this,3e3))},_getNextUnloadedPage:function(){return this._getPagesList().pages.first(function(e){return!this.isPageLoaded(e.pageId)&&this._loadingPagesTrialCounter[e.pageId]<=3}.bind(this))},_getPagesToLoad:function(){var e=this.getMainPage();this._isPageReal(e)||(e=this._getPagesList().pages[0].pageId);var t=[e],n=W.Utils.hash.getHashParts(),r=n.id==="zoom"?n.extData.match("([^/]+)/([^/]+)")[1]:n.id;return!!r&&r!==this.getMainPage()&&this._isPageReal(r)&&t.push(r),t},_isPageReal:function(e){return this._getPagesList().pages.some(function(t){return t.pageId===e})},_loadSiteNewVersion:function(){this._loadAllPages(this._getPagesToLoad()),this.getMasterPageData(this._createMasterPage),W.Utils.callLater(this._loadAllPagesLazily,[],this,15e3)}})}),define.experiment.Class("wysiwyg.viewer.utils.TransitionUtils.MobileFixes.New",function(e,t){var n=e,r=t;n.resources(["W.Config"]),n.methods({getTransition:function(e){if(this.resources.W.Config.mobileConfig.isMobileOrTablet())return this._noTransition;switch(e){case Constants.TransitionTypes.SWIPE_HORIZONTAL:return this._swipeHorizontalTransition;case Constants.TransitionTypes.SWIPE_HORIZONTAL_FULLSCREEN:return this._swipeHorizontalTransitionFullScreen;case Constants.TransitionTypes.SWIPE_VERTICAL:return this._swipeVerticalTransition;case Constants.TransitionTypes.SWIPE_VERTICAL_FULLSCREEN:return this._swipeVerticalTransitionFullScreen;case Constants.TransitionTypes.CROSS_FADE:return this._crossFadeTransition;case Constants.TransitionTypes.SHRINK_FADE:return this._shrinkFadeTransition;case Constants.TransitionTypes.OUT_IN:return this._inOutTransition;case Constants.TransitionTypes.NONE:default:return this._noTransition}}})});